{% extends "base.html" %}

{% block page_title %}Dashboard Administrateur{% endblock %}

{% block content %}
<style>
/* ==============================
   Style général du dashboard
   ============================== */
body {
    margin: 0;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    min-height: 50vh;
    padding: 1rem;
    background: #e4e3e3;
}

.dashboard-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 100%;
    max-width: 1200px;
}

/* Boutons centraux */
.central-btns {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 1rem;
    margin-bottom: 2rem;
}
.central-btns a {
    text-decoration: none;
    padding: 0.5rem 1.5rem;
    font-weight: 700;
    border-radius: 50px;
    background: linear-gradient(135deg,#0d6efd,#3390ff);
    color: white;
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    box-shadow: 0 5px 10px rgba(0,0,0,0.15);
    transition: transform 0.2s, box-shadow 0.2s;
}
.central-btns a:hover {
    transform: scale(1.05);
    box-shadow: 0 0 15px rgba(13,110,253,0.4);
}

/* Tableau stylé */
.table-container {
    overflow-x: auto;
    width: 100%;
    max-width: 1100px;
    margin-top: 2rem;
}
table {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0;
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 5px 15px rgba(0,0,0,0.15);
    background: rgba(255,255,255,0.95);
}
thead {
    background: #0d6efd;
    color: white;
    font-weight: 600;
}
tbody tr:hover {
    background: rgba(13,110,253,0.05);
    transition: background 0.3s;
}
td, th {
    padding: 0.8rem 1rem;
    text-align: center;
    vertical-align: middle;
}

/* Boutons d'actions bleus, centrés et sans soulignement */
td[data-label="Actions"] {
    text-align: center;
}
td[data-label="Actions"] a {
    display: inline-block;
    text-decoration: none;
    font-size: 0.85rem;
    padding: 0.4rem 0.9rem;
    border-radius: 20px;
    font-weight: 600;
    margin: 0.2rem;
    transition: transform 0.2s, box-shadow 0.2s;
    background-color: #0d6efd;
    color: white !important;
}
td[data-label="Actions"] a:hover {
    transform: scale(1.05);
    box-shadow: 0 0 8px rgba(0,0,0,0.2);
}

tbody tr td[colspan] {
    color: #666;
    font-style: italic;
    padding: 1rem;
}

/* Titre des sections */
.table-container h3 { margin-bottom: 0.8rem; }
</style>

<div class="dashboard-container">

    {% if user.role == "admin" %}
   <div class="central-btns" style="display: flex; flex-wrap: wrap; gap: 1rem; margin-bottom: 2rem;">
    <a href="{% url 'attribuer_moto' %}" class="btn btn-primary"><i class="bi bi-bicycle"></i> Attribuer une moto</a>
    <a href="{% url 'bilan_general' %}" class="btn btn-primary"><i class="bi bi-bar-chart-line"></i> Bilan Général</a>
    <a href="{% url 'ajouter_moto' %}" class="btn btn-primary"><i class="bi bi-plus-circle"></i> Gestion des motos</a>
    <a href="{% url 'register' %}" class="btn btn-primary"><i class="bi bi-person-plus"></i> Créer un compte</a>
    <a href="{% url 'ajouter_recette' %}" class="btn btn-primary"><i class="bi bi-cash-stack"></i> Saisir recettes</a>
    <a href="{% url 'liste_conducteurs' %}" class="btn btn-primary"><i class="bi bi-person-lines-fill"></i> Mes conducteurs</a>
    <a href="{% url 'liste_questions' %}" class="btn btn-primary"><i class="bi bi-question-circle"></i> Questions en attente</a>
    <a href="{% url 'clients_list' %}" class="btn btn-primary"><i class="bi bi-people"></i> Voir les clients</a>
    <a href="{% url 'reservation' %}" class="btn btn-primary"><i class="bi bi-card-checklist"></i>Réservations & Abonnements</a>
    <a href="{% url 'reservations_admin' %}" class="btn btn-primary"><i class="bi bi-card-rapid"></i>Réservations rapides</a>
</div>

    {% endif %}

    <!-- =================== CONDUCTEURS =================== -->
    <div class="table-container">
        <table>
            <thead>
                <tr>
                    <th>Moto</th>
                    <th>Conducteur</th>
                    <th>Téléphone</th>
                    <th>Adresse</th>
                    <th>Recette du jour</th>
                    <th>Dépenses du jour</th>
                    {% if user.role == "admin" %}<th>Actions</th>{% endif %}
                </tr>
            </thead>
            <tbody>
            {% for item in conducteurs %}
                <tr>
                    <td data-label="Moto">{{ item.conducteur.moto|default:"Aucune" }}</td>
                    <td data-label="Conducteur">{{ item.conducteur.user.get_full_name }}</td>
                    <td data-label="Téléphone">{{ item.conducteur.telephone }}</td>
                    <td data-label="Adresse">{{ item.conducteur.adresse }}</td>
                    <td data-label="Recette du jour">{% if item.recette_du_jour %}{{ item.recette_du_jour.montant }} FCFA{% else %}-{% endif %}</td>
                    <td data-label="Dépense du jour">{{ item.recette_du_jour.depense|default:"-" }} FCFA</td>
                    {% if user.role == "admin" %}
                    <td data-label="Actions">
                        <a href="{% url 'ajouter_absence' item.conducteur.id %}">Absence</a>
                        <a href="{% url 'conducteur_detail' item.conducteur.id %}">Détails</a>
                        {% if item.recette_du_jour %}
                            <a href="{% url 'modifier_recette' item.recette_du_jour.id %}">Recette</a>
                        {% endif %}
                        <a href="{% url 'modifier_conducteur' item.conducteur.id %}">Modifier</a>
                    </td>
                    {% endif %}
                </tr>
            {% empty %}
                <tr><td colspan="7">Aucun conducteur trouvé.</td></tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
    
{% endblock %}
